<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Harvard Cover</title>
  <link rel="icon" type="image/png" href="images/favicon-inverted.png">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .color-button {
      width: 50px;
      height: 50px;
      border: none;
      cursor: pointer;
      border: 2px solid #000;
    }

    .preview {
      width: 733px;
      height: 307px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      margin: 20px 0;
      border: 1px solid #ccc;
    }

    .background {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .pattern {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .pattern-svg {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <main>
    <h1>Harvard Cover</h1>
    <p>Generate custom blog post covers</p>

    <!-- Background Color Selection -->
    <div class="controls">
      <h3>Select Background Color:</h3>
      <button class="color-button" style="background-color: red;" data-color="red"></button>
      <button class="color-button" style="background-color: green;" data-color="green"></button>
      <button class="color-button" style="background-color: blue;" data-color="blue"></button>
    </div>

    <!-- Pattern Color Selection -->
    <div class="controls">
      <h3>Select Pattern Color:</h3>
      <button class="color-button" style="background-color: yellow;" data-pattern-color="yellow"></button>
      <button class="color-button" style="background-color: pink;" data-pattern-color="pink"></button>
      <button class="color-button" style="background-color: brown;" data-pattern-color="brown"></button>
    </div>

    <!-- Preview -->
    <div id="preview" class="preview">
      <div class="background" style="background-color: red;"></div>
      <div class="pattern">
        <!-- Embed the SVG content here -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="pattern-svg">
          <circle cx="20" cy="20" r="10" fill="yellow" />
          <circle cx="50" cy="50" r="10" fill="yellow" />
          <circle cx="80" cy="80" r="10" fill="yellow" />
        </svg>
      </div>
    </div>

    <!-- Download Button -->
    <button id="download-btn">Download as PNG</button>
  </main>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    const preview = document.getElementById('preview');
    const backgroundDiv = preview.querySelector('.background');
    const patternDiv = preview.querySelector('.pattern');
    const colorButtons = document.querySelectorAll('.color-button[data-color]');
    const patternColorButtons = document.querySelectorAll('.color-button[data-pattern-color]');
    const downloadBtn = document.getElementById('download-btn');

    // Change background color
    colorButtons.forEach(button => {
      button.addEventListener('click', () => {
        const color = button.getAttribute('data-color');
        backgroundDiv.style.backgroundColor = color;
      });
    });

    // Change pattern color
    patternColorButtons.forEach(button => {
      button.addEventListener('click', () => {
        const patternColor = button.getAttribute('data-pattern-color');
        const circles = patternDiv.querySelectorAll('circle');
        circles.forEach(circle => {
          circle.setAttribute('fill', patternColor); // Change the color of each circle
        });
      });
    });

    // Load and apply pattern from the patterns folder
    function loadPattern(patternFile) {
      fetch(`patterns/${patternFile}`)
        .then(response => response.text())
        .then(svgContent => {
          patternDiv.innerHTML = svgContent; // Replace the current pattern with the loaded SVG
        })
        .catch(error => console.error('Error loading pattern:', error));
    }

    // Example: Load a specific pattern (you can replace 'pattern1.svg' with other filenames)
    loadPattern('pattern1.svg');

    // Download as PNG
    downloadBtn.addEventListener('click', () => {
      html2canvas(preview).then(canvas => {
        const link = document.createElement('a');
        link.download = 'harvard-cover.png';
        link.href = canvas.toDataURL();
        link.click();
      });
    });
  </script>
</body>

</html>